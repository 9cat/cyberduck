<?xml version="1.0" encoding="UTF-8"?>
<!--
 *	Simple Ant (http://jakarta.apache.org/ant) build script for Cyberduck
 *
 *	$Revision$
 *	$Date$
 *
 *  Copyright (c) 2005-2012 David Kocher. All rights reserved.
 *  http://cyberduck.io/
 *
 *	This program is free software; you can redistribute it and/or modify
 *	it under the terms of the GNU General Public License as published by
 *	the Free Software Foundation; either version 2 of the License, or
 *	(at your option) any later version.
 *
 *	This program is distributed in the hope that it will be useful,
 *	but WITHOUT ANY WARRANTY; without even the implied warranty of
 *	MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *	GNU General Public License for more details.
 *
 *	Bug fixes, suggestions and comments should be sent to:
 *	dkocher@cyberduck.io
 -->
<project name="Cyberduck for Linux" basedir=".">

    <import file="build.xml"/>

    <property name="cli.bundles" value="all"/>
    <property name="app.icon" value="cyberduck-application.png"/>
    <property name="jvm.runtime.bundle.home" value="${java.home}"/>

    <target name="_build"/>

    <target name="upload">
        <antcall target="_upload">
            <param name="bundle.type" value=".deb"/>
        </antcall>
        <antcall target="_upload">
            <param name="bundle.type" value="-1.i686.rpm"/>
        </antcall>
        <antcall target="_upload">
            <param name="bundle.type" value="-1.x86_64.rpm"/>
        </antcall>
    </target>

    <target name="findbundle">
        <available
                file="${build.bundles}/duck-${cyberduck.version.major}.${cyberduck.version.minor}.${svn.revision}${bundle.type}"
                property="bundle.exists"/>
    </target>

    <target name="_upload" depends="findbundle" if="bundle.exists">
        <checksum
                file="${build.bundles}/duck-${cyberduck.version.major}.${cyberduck.version.minor}.${svn.revision}${bundle.type}"
                algorithm="md5"/>
        <scp file="${build.bundles}/duck-${cyberduck.version.major}.${cyberduck.version.minor}.${svn.revision}${bundle.type}.md5"
             todir="${uri}"
             trust="true"
             keyfile="${user.home}/.ssh/update.cyberduck.io-rsa"
             passphrase="">
        </scp>
        <scp file="${build.bundles}/duck-${cyberduck.version.major}.${cyberduck.version.minor}.${svn.revision}${bundle.type}"
             todir="${uri}"
             trust="true"
             keyfile="${user.home}/.ssh/update.cyberduck.io-rsa"
             passphrase="">
        </scp>
    </target>

    <target name="nightly" depends="cli">
        <antcall target="upload">
            <param name="uri" value="dkocher@update.cyberduck.io:./update.cyberduck.io/linux/nightly/"/>
        </antcall>
    </target>

    <target name="beta" depends="cli">
        <antcall target="upload">
            <param name="uri" value="dkocher@update.cyberduck.io:./update.cyberduck.io/linux/beta/"/>
        </antcall>
    </target>

    <target name="release" depends="cli">
        <antcall target="upload">
            <param name="uri" value="dkocher@update.cyberduck.io:./update.cyberduck.io/linux/"/>
        </antcall>
    </target>
</project>
